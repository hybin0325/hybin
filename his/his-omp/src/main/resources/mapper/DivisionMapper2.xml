<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="net.medcrm.yjb.his.omp.dao.Division2Mapper" >
  <resultMap id="BaseResultMap" type="net.medcrm.yjb.his.omp.domain.Division" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Oct 24 14:36:26 CST 2017.
    -->
    <id column="id" property="id" jdbcType="VARCHAR" />
    <result column="fullName" property="fullName" jdbcType="VARCHAR" />
    <result column="abbr" property="abbr" jdbcType="VARCHAR" />
    <result column="code" property="code" jdbcType="VARCHAR" />
    <result column="telphone1" property="telphone1" jdbcType="VARCHAR" />
    <result column="telphone2" property="telphone2" jdbcType="VARCHAR" />
    <result column="fax" property="fax" jdbcType="VARCHAR" />
    <result column="address" property="address" jdbcType="VARCHAR" />
    <result column="status" property="status" jdbcType="INTEGER" />
    <result column="type" property="type" jdbcType="INTEGER" />
    <result column="diviType" property="diviType" jdbcType="INTEGER" />
    <result column="sort" property="sort" jdbcType="INTEGER" />
    <result column="pid" property="pid" jdbcType="VARCHAR" />
    <result column="pids" property="pids" jdbcType="VARCHAR" />
    <result column="level" property="level" jdbcType="INTEGER" />
    <result column="postCode" property="postCode" jdbcType="VARCHAR" />
    <result column="bedNumber" property="bedNumber" jdbcType="INTEGER" />
    <result column="meeting" property="meeting" jdbcType="VARCHAR" />
    <result column="duty" property="duty" jdbcType="VARCHAR" />
    <result column="visibleInDiagram" property="visibleInDiagram" jdbcType="VARCHAR" />
  </resultMap>
  <resultMap id="DivisionEmployee" type="net.medcrm.yjb.his.omp.domain.Employee">
    <id column="id" property="id" jdbcType="VARCHAR" />
    <result column="fullName" property="fullName" jdbcType="VARCHAR" />
  </resultMap>

  <sql id="Base_Column_List" >
    id, fullName, abbr, code, telphone1, telphone2, fax, address, status, type, diviType,
    sort, pid, pids, level, postCode, bedNumber, meeting, duty,
    visibleInDiagram
  </sql>
  <select id="selectBaseDivisionById" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select
    id,fullName,abbr,code,telphone1,telphone2,fax,address,pid,sort,bedNumber,postCode,visibleInDiagram,level
    from hr_division
    where id = #{id,jdbcType=VARCHAR}
  </select>
  <select id="selectAll" resultType="net.medcrm.yjb.his.omp.domain.Division">
    select
    id,fullName,abbr,telphone1,telphone2,fax,address,pid,postCode,visibleInDiagram
    from hr_division
    where status=0 AND diviType=1
  </select>
  <select id="selectLeaderNameById" resultType="java.lang.String">
    select e.fullName
    from hr_division d
    INNER JOIN hr_division_position dp on d.id = dp.diviId
    INNER JOIN hr_employee e on dp.employId = e.id
    WHERE d.id=#{id} AND dp.posiId = '1'

  </select>
  <select id="selectSuspendAll" resultType="net.medcrm.yjb.his.omp.domain.Division">
    select
    <include refid="Base_Column_List" />
    from hr_division
    where status=1 AND diviType=1
  </select>
  <select id="selectPidsById" resultMap="BaseResultMap" parameterType="java.lang.String">
    select id,pids
    from hr_division
    where status=0 AND diviType=1 AND id=#{id,jdbcType=VARCHAR}
  </select>
  <select id="countDivisionByLevel" resultType="java.lang.Integer" >
    select count(*)
    from hr_division
    where status=0 AND diviType=2 AND level=#{level,jdbcType=INTEGER} AND pid=#{pid,jdbcType=VARCHAR}

  </select>
  <select id="selectLeadersById" resultMap="DivisionEmployee">
    select
    id,
    fullName
    from hr_employee
    WHERE id IN
    <foreach collection="listId" open="(" close=")" separator="," item="listId" index="i">
      #{listId}
    </foreach>
  </select>
  <select id="isPlegalById" resultType="java.lang.Integer">
    select
    count(*)
    FROM hr_division a
    INNER JOIN hr_division b on a.id = b.pid
    WHERE a.id = #{id}
  </select>
  <update id="deleteByListId" parameterType="java.util.List" >

    UPDATE hr_division
    SET status=2
    WHERE id IN
    <foreach collection="listId" open="(" close=")" separator="," item="listId" index="i">
      #{listId}
    </foreach>
  </update>
  <insert id="insert" parameterType="net.medcrm.yjb.his.omp.domain.Division" >
    insert into hr_division
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="fullName != null" >
        fullName,
      </if>
      <if test="abbr != null" >
        abbr,
      </if>
      <if test="code != null" >
        code,
      </if>
      <if test="telphone1 != null" >
        telphone1,
      </if>
      <if test="telphone2 != null" >
        telphone2,
      </if>
      <if test="fax != null" >
        fax,
      </if>
      <if test="address != null" >
        address,
      </if>
      <if test="status != null" >
        status,
      </if>
      <if test="type != null" >
        type,
      </if>
      <if test="diviType != null" >
        diviType,
      </if>
      <if test="sort != null" >
        sort,
      </if>
      <if test="pid != null" >
        pid,
      </if>
      <if test="pids != null" >
        pids,
      </if>
      <if test="level != null" >
        level,
      </if>
      <if test="postCode != null" >
        postCode,
      </if>
      <if test="bedNumber != null" >
        bedNumber,
      </if>
      <if test="meeting != null" >
        meeting,
      </if>
      <if test="duty != null" >
        duty,
      </if>
      <if test="visibleInDiagram != null" >
        visibleInDiagram,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=VARCHAR},
      </if>
      <if test="fullName != null" >
        #{fullName,jdbcType=VARCHAR},
      </if>
      <if test="abbr != null" >
        #{abbr,jdbcType=VARCHAR},
      </if>
      <if test="code != null" >
        #{code,jdbcType=VARCHAR},
      </if>
      <if test="telphone1 != null" >
        #{telphone1,jdbcType=VARCHAR},
      </if>
      <if test="telphone2 != null" >
        #{telphone2,jdbcType=VARCHAR},
      </if>
      <if test="fax != null" >
        #{fax,jdbcType=VARCHAR},
      </if>
      <if test="address != null" >
        #{address,jdbcType=VARCHAR},
      </if>
      <if test="status != null" >
        #{status,jdbcType=INTEGER},
      </if>
      <if test="type != null" >
        #{type,jdbcType=INTEGER},
      </if>
      <if test="diviType != null" >
        #{diviType,jdbcType=INTEGER},
      </if>
      <if test="sort != null" >
        #{sort,jdbcType=INTEGER},
      </if>
      <if test="pid != null" >
        #{pid,jdbcType=VARCHAR},
      </if>
      <if test="pids != null" >
        #{pids,jdbcType=VARCHAR},
      </if>
      <if test="level != null" >
        #{level,jdbcType=INTEGER},
      </if>
      <if test="postCode != null" >
        #{postCode,jdbcType=VARCHAR},
      </if>
      <if test="bedNumber != null" >
        #{bedNumber,jdbcType=INTEGER},
      </if>
      <if test="meeting != null" >
        #{meeting,jdbcType=VARCHAR},
      </if>
      <if test="duty != null" >
        #{duty,jdbcType=VARCHAR},
      </if>
      <if test="visibleInDiagram != null" >
        #{visibleInDiagram,jdbcType=VARCHAR},
      </if>
    </trim>

  </insert>
  <insert id="insertDivision" parameterType="net.medcrm.yjb.his.omp.domain.Division" >

    insert into hr_division
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="fullName != null" >
        fullName,
      </if>
      <if test="abbr != null" >
        abbr,
      </if>
      <if test="code != null" >
        code,
      </if>
      <if test="telphone1 != null" >
        telphone1,
      </if>
      <if test="telphone2 != null" >
        telphone2,
      </if>
      <if test="fax != null" >
        fax,
      </if>
      <if test="address != null" >
        address,
      </if>
      <if test="status != null" >
        status,
      </if>
      <if test="type != null" >
        type,
      </if>
      <if test="diviType != null" >
        diviType,
      </if>
      <if test="sort != null" >
        sort,
      </if>
      <if test="pid != null" >
        pid,
      </if>
      <if test="pids != null" >
        pids,
      </if>
      <if test="level != null" >
        level,
      </if>
      <if test="postCode != null" >
        postCode,
      </if>
      <if test="bedNumber != null" >
        bedNumber,
      </if>
      <if test="meeting != null" >
        meeting,
      </if>
      <if test="duty != null" >
        duty,
      </if>
      <if test="visibleInDiagram != null" >
        visibleInDiagram,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=VARCHAR},
      </if>
      <if test="fullName != null" >
        #{fullName,jdbcType=VARCHAR},
      </if>
      <if test="abbr != null" >
        #{abbr,jdbcType=VARCHAR},
      </if>
      <if test="code != null" >
        #{code,jdbcType=VARCHAR},
      </if>
      <if test="telphone1 != null" >
        #{telphone1,jdbcType=VARCHAR},
      </if>
      <if test="telphone2 != null" >
        #{telphone2,jdbcType=VARCHAR},
      </if>
      <if test="fax != null" >
        #{fax,jdbcType=VARCHAR},
      </if>
      <if test="address != null" >
        #{address,jdbcType=VARCHAR},
      </if>
      <if test="status != null" >
        #{status,jdbcType=INTEGER},
      </if>
      <if test="type != null" >
        #{type,jdbcType=INTEGER},
      </if>
      <if test="diviType != null" >
        #{diviType,jdbcType=INTEGER},
      </if>
      <if test="sort != null" >
        #{sort,jdbcType=INTEGER},
      </if>
      <if test="pid != null" >
        #{pid,jdbcType=VARCHAR},
      </if>
      <if test="pids != null" >
        #{pids,jdbcType=VARCHAR},
      </if>
      <if test="level != null" >
        #{level,jdbcType=INTEGER},
      </if>
      <if test="postCode != null" >
        #{postCode,jdbcType=VARCHAR},
      </if>
      <if test="bedNumber != null" >
        #{bedNumber,jdbcType=INTEGER},
      </if>
      <if test="meeting != null" >
        #{meeting,jdbcType=VARCHAR},
      </if>
      <if test="duty != null" >
        #{duty,jdbcType=VARCHAR},
      </if>
      <if test="visibleInDiagram != null" >
        #{visibleInDiagram,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateLegal" parameterType="net.medcrm.yjb.his.omp.domain.Division" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Oct 24 14:36:26 CST 2017.
    -->
    update hr_division
    <set >
      <if test="fullName != null" >
        fullName = #{fullName,jdbcType=VARCHAR},
      </if>
      <if test="abbr != null" >
        abbr = #{abbr,jdbcType=VARCHAR},
      </if>
      <if test="code != null" >
        code = #{code,jdbcType=VARCHAR},
      </if>
      <if test="telphone1 != null" >
        telphone1 = #{telphone1,jdbcType=VARCHAR},
      </if>
      <if test="telphone2 != null" >
        telphone2 = #{telphone2,jdbcType=VARCHAR},
      </if>
      <if test="fax != null" >
        fax = #{fax,jdbcType=VARCHAR},
      </if>
      <if test="address != null" >
        address = #{address,jdbcType=VARCHAR},
      </if>
      <if test="status != null" >
        status = #{status,jdbcType=INTEGER},
      </if>
      <if test="type != null" >
        type = #{type,jdbcType=INTEGER},
      </if>
      <if test="diviType != null" >
        diviType = #{diviType,jdbcType=INTEGER},
      </if>
      <if test="sort != null" >
        sort = #{sort,jdbcType=INTEGER},
      </if>
      <if test="pid != null" >
        pid = #{pid,jdbcType=VARCHAR},
      </if>
      <if test="pids != null" >
        pids = #{pids,jdbcType=VARCHAR},
      </if>
      <if test="level != null" >
        level = #{level,jdbcType=INTEGER},
      </if>
      <if test="postCode != null" >
        postCode = #{postCode,jdbcType=VARCHAR},
      </if>
      <if test="bedNumber != null" >
        bedNumber = #{bedNumber,jdbcType=INTEGER},
      </if>
      <if test="meeting != null" >
        meeting = #{meeting,jdbcType=VARCHAR},
      </if>
      <if test="duty != null" >
        duty = #{duty,jdbcType=VARCHAR},
      </if>
      <if test="visibleInDiagram != null" >
        visibleInDiagram = #{visibleInDiagram,jdbcType=VARCHAR},
      </if>
    </set>
    where id = #{id,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="net.medcrm.yjb.his.omp.domain.Division" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Oct 24 14:36:26 CST 2017.
    -->
    update hr_division
    set fullName = #{fullName,jdbcType=VARCHAR},
      abbr = #{abbr,jdbcType=VARCHAR},
      code = #{code,jdbcType=VARCHAR},
      telphone1 = #{telphone1,jdbcType=VARCHAR},
      telphone2 = #{telphone2,jdbcType=VARCHAR},
      fax = #{fax,jdbcType=VARCHAR},
      address = #{address,jdbcType=VARCHAR},
      status = #{status,jdbcType=INTEGER},
      type = #{type,jdbcType=INTEGER},
      diviType = #{diviType,jdbcType=INTEGER},
      sort = #{sort,jdbcType=INTEGER},
      pid = #{pid,jdbcType=VARCHAR},
      pids = #{pids,jdbcType=VARCHAR},
      level = #{level,jdbcType=INTEGER},
      postCode = #{postCode,jdbcType=VARCHAR},
      bedNumber = #{bedNumber,jdbcType=INTEGER},
      meeting = #{meeting,jdbcType=VARCHAR},
      duty = #{duty,jdbcType=VARCHAR},
      visibleInDiagram = #{visibleInDiagram,jdbcType=VARCHAR}
    where id = #{id,jdbcType=VARCHAR}
  </update>
</mapper>